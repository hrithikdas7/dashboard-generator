/**
 * Mock data handlers
 * Generated by Dashboard Generator
 *
 * This file provides mock data for development when the backend is not available.
 * You can use this with MSW (Mock Service Worker) or as static imports.
 *
 * For MSW setup, see: https://mswjs.io/docs/getting-started
 */

{{#each entities}}
import {{camelCase pluralName}}Data from './{{slug}}.json';
{{/each}}

// Re-export mock data
{{#each entities}}
export const mock{{pluralName}} = {{camelCase pluralName}}Data;
{{/each}}

/**
 * Helper to simulate paginated responses
 */
export function paginateData<T>(
  data: T[],
  page: number = 1,
  pageSize: number = 20,
  search?: string,
  searchFields?: string[]
): {
  data: T[];
  total: number;
  page: number;
  pageSize: number;
  totalPages: number;
} {
  let filteredData = [...data];

  // Apply search filter
  if (search && searchFields && searchFields.length > 0) {
    const searchLower = search.toLowerCase();
    filteredData = filteredData.filter((item) =>
      searchFields.some((field) => {
        const value = (item as Record<string, unknown>)[field];
        return value && String(value).toLowerCase().includes(searchLower);
      })
    );
  }

  const total = filteredData.length;
  const totalPages = Math.ceil(total / pageSize);
  const startIndex = (page - 1) * pageSize;
  const paginatedData = filteredData.slice(startIndex, startIndex + pageSize);

  return {
    data: paginatedData,
    total,
    page,
    pageSize,
    totalPages,
  };
}

/**
 * Helper to simulate API delay
 */
export function delay(ms: number = 200): Promise<void> {
  return new Promise((resolve) => setTimeout(resolve, ms));
}

/**
 * Helper to generate a random ID
 */
export function generateId(): string {
  return Math.random().toString(36).substring(2, 11);
}

/**
 * Mock API handlers object
 * Can be used to intercept fetch/axios calls in development
 */
export const mockHandlers = {
{{#each entities}}
  // {{pluralName}} handlers
  '{{slug}}': {
    list: (params: { page?: number; pageSize?: number; search?: string }) => {
      return paginateData(
        mock{{pluralName}},
        params.page,
        params.pageSize,
        params.search,
        [{{#each listConfig.searchableFields}}'{{this}}'{{#unless @last}}, {{/unless}}{{/each}}]
      );
    },
    get: (id: string) => {
      return mock{{pluralName}}.find((item) => item.id === id) || null;
    },
    create: (data: Omit<(typeof mock{{pluralName}})[0], 'id' | 'createdAt' | 'updatedAt'>) => {
      const newItem = {
        ...data,
        id: generateId(),
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
      };
      mock{{pluralName}}.push(newItem as (typeof mock{{pluralName}})[0]);
      return newItem;
    },
    update: (id: string, data: Partial<(typeof mock{{pluralName}})[0]>) => {
      const index = mock{{pluralName}}.findIndex((item) => item.id === id);
      if (index === -1) return null;
      mock{{pluralName}}[index] = {
        ...mock{{pluralName}}[index],
        ...data,
        updatedAt: new Date().toISOString(),
      };
      return mock{{pluralName}}[index];
    },
    delete: (id: string) => {
      const index = mock{{pluralName}}.findIndex((item) => item.id === id);
      if (index === -1) return false;
      mock{{pluralName}}.splice(index, 1);
      return true;
    },
  },
{{/each}}
};
