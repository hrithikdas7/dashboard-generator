/**
 * {{entity.name}} List Page
 * Generated by Dashboard Generator
 */

import { Link } from 'react-router-dom';
import { PageHeader } from '@/components/layout';
import { DataTable, Button, Badge, ConfirmModal, getStatusVariant } from '@/components/common';
import type { Column } from '@/components/common';
import { formatDate, formatCurrency } from '@/utils/format';
import { use{{entity.name}}ListPage } from './use{{entity.name}}ListPage';
import type { {{entity.name}} } from '@/types';

export function {{entity.name}}ListPage() {
  const {
    {{camelCase entity.pluralName}},
    total,
    isLoading,
    page,
    setPage,
    pageSize,
    search,
    setSearch,
    sortField,
    sortDirection,
    handleSort,
    deleteId,
    setDeleteId,
    isDeleting,
    handleDelete,
    handleRowClick,
  } = use{{entity.name}}ListPage();

  const columns: Column<{{entity.name}}>[] = [
{{#each entity.fields}}
{{#if showInList}}
    {
      key: '{{name}}',
      header: '{{label}}',
      sortable: true,
{{#if (eq type "enum")}}
      render: (value) => (
        <Badge variant={getStatusVariant(String(value))}>
          {String(value)}
        </Badge>
      ),
{{else if (eq type "boolean")}}
      render: (value) => (
        <Badge variant={value ? 'success' : 'default'}>
          {value ? 'Yes' : 'No'}
        </Badge>
      ),
{{else if (eq type "date")}}
      render: (value) => formatDate(String(value)),
{{else if (eq type "datetime")}}
      render: (value) => formatDate(String(value)),
{{else if (eq type "number")}}
{{#if (eq name "price")}}
      render: (value) => formatCurrency(value as number),
{{/if}}
{{/if}}
    },
{{/if}}
{{/each}}
  ];

  return (
    <div>
      <PageHeader
        title="{{entity.pluralName}}"
        description="Manage your {{lowerCase entity.pluralName}}"
        breadcrumbs={[
          { label: 'Dashboard', href: '/' },
          { label: '{{entity.pluralName}}' },
        ]}
        action={
          <Link to="/{{entity.slug}}/new">
            <Button>Add {{entity.name}}</Button>
          </Link>
        }
      />

      <DataTable<{{entity.name}}>
        data={ {{camelCase entity.pluralName}} }
        columns={columns}
        isLoading={isLoading}
        searchValue={search}
        onSearchChange={setSearch}
        searchPlaceholder="Search {{lowerCase entity.pluralName}}..."
        sortField={sortField}
        sortDirection={sortDirection}
        onSort={handleSort}
        pagination=\{{
          page,
          pageSize,
          total,
          onPageChange: setPage,
        }}
        onRowClick={(row) => handleRowClick(row.id)}
        actions={(row) => (
          <div className="flex items-center justify-end gap-2">
            <Link
              to={`/{{entity.slug}}/${row.id}`}
              className="text-sm text-gray-600 hover:text-gray-900"
            >
              View
            </Link>
            <Link
              to={`/{{entity.slug}}/${row.id}/edit`}
              className="text-sm text-primary-600 hover:text-primary-700"
            >
              Edit
            </Link>
            <button
              onClick={(e) => {
                e.stopPropagation();
                setDeleteId(row.id);
              }}
              className="text-sm text-red-600 hover:text-red-700"
            >
              Delete
            </button>
          </div>
        )}
      />

      {/* Delete confirmation modal */}
      <ConfirmModal
        isOpen={!!deleteId}
        onClose={() => setDeleteId(null)}
        onConfirm={handleDelete}
        title="Delete {{entity.name}}"
        message="Are you sure you want to delete this {{lowerCase entity.name}}? This action cannot be undone."
        confirmLabel="Delete"
        variant="danger"
        isLoading={isDeleting}
      />
    </div>
  );
}
